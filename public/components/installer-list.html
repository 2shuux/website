<link rel="import" href="/static/polymer/polymer.html">
<link rel="import" href="/static/iron-ajax/iron-ajax.html">

<dom-module id="installer-list">
  <template>
      <style>
        .installer-revision-list {
          list-style-type:none;
          padding: 0;
        }
        .btn {
          width: 100%;
          margin: 4px 0;
        }
      </style>
      <ul class="installer-revision-list">
        <template is="dom-repeat" id="installer-list" items={{installers}} as="installer">
          <li>
            <a
              class="btn btn-primary"
              data-installer-slug$="[[installer.slug]]"
              on-tap="onInstallerClick">
              [[installer.slug]]
            </a>
          </li>
          <template is="dom-repeat" id="revision-list" items={{installer.revisions}} as="revision">
            <li>
              <a
                class="btn"
                data-installer-slug$="[[installer.slug]]"
                data-revision-id$="[[revision.id]]"
                on-tap="onRevisionClick"
                title="[[revision.comment]]">
                [[installer.slug]]
              </a>
            </li>
          </template>
        </template>
      </ul>


  </template>
  <script>
    Polymer({
      is: 'installer-list',
      properties: {
        installers: Object
      },
      ready: function() {
        console.log(this.installers);
      },
      onInstallerClick: function(event) {
        const installerSlug = event.target.attributes['data-installer-slug'].value;
        this.fire('load-installer', {'installerSlug': installerSlug});
      },
      onRevisionClick: function(event) {
        const installerSlug = event.target.attributes['data-installer-slug'].value;
        const revisionId = event.target.attributes['data-revision-id'].value;
        this.fire('load-revision', {'installerSlug': installerSlug, 'revisionId': revisionId})
      }
    })
  </script>
</dom-module>
