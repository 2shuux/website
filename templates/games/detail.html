{% extends "base.html" %}
{% load thumbnail %}

{% block title %}{{ game.name }} - Lutris{% endblock %}

{% block content %}
  <div class="page-header">
    <div class='title'>
      {% if game.icon %}
        <img src='{{ MEDIA_URL }}{{ game.icon }}' width='32' height='32' />
      {% endif %}
      <span>{{ game.name }}</span>
      {% if user.is_staff %}
        <div class="buttons">
          <a class="btn" href="{% url 'admin:games_game_change' game.id %}">Edit</a>
        </div>
      {% endif %}
    </div>
  </div>

  <div class="row">
    <div class="col-xs-9">
      {% with game.screenshot_set.published as screenshots %}
      {% include "includes/screenshots_slider.jade" %}
      {% endwith %}
      <div class="screenshots-bar">
        <a href='{% url 'screenshot_add' game.slug %}' class='discreet-text right'>Submit screenshot</a>
      </div>
      <div class="installer-list">
        {% if installers %}
        <ul>
          {% for installer in installers %}
            {% include "games/_installer.html" %}
          {% endfor %}
        </ul>
        {% endif %}
        {% if auto_installers %}
        <ul>
          {% for installer in auto_installers %}
            {% include "games/_installer.html" %}
          {% endfor %}
        </ul>
        {% endif %}
        <div class="new-installer">
          <a href="{% url "new_installer" slug=game.slug %}" class="discreet-text right">Write a new installer</a>
        </div>
      </div>
      <article>
        {{ game.description|linebreaks }}
      </article>
    </div>
    <div class="col-xs-3">
      <div class="game-info">
        {% thumbnail game.title_logo "184" as img %}
          <img src="{{ img.url }}" class="banner" />
        {% endthumbnail %}
        <ul>
          <li>
            <span class="info-label">Genre: </span>
            {% for genre in game.genres.all %}
              {{ genre }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
          </li>
          <li>
            <span class="info-label">Platform: </span>
            {% for platform in game.platforms.all %}
              {{ platform }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
          </li>
          {% if game.developer %}
          <li>
            <span class="info-label">Developer: </span>
            <a href="{{ game.developer.get_absolute_url }}">{{ game.developer }}</a>
          </li>
          {% endif %}
          {% if game.publisher %}
          <li>
            <span class="info-label">Publisher: </span>
            <a href="{{ game.publisher.get_absolute_url }}">{{ game.publisher }}</a>
          </li>
          {% endif %}
          <li>
            <span class="info-label">Release year: </span>
            {% firstof game.year "Unknown" %}
          </li>
          {% if game.website %}
          <li class="ellipse-text">
              <span class="info-label">Website: </span>
              <a href='{{ game.website }}'>{{ game.website_text }}</a>
          </li>
          {% endif %}
        </ul>
        <div class="centered">
          <p>
            {% if not in_library %}
            <a href="{% url "add_to_library" slug=game.slug %}" class="btn">Add to my library</a>
            {% else %}
            <a href="{% url "remove_from_library" slug=game.slug %}" class="btn in-library">
              <span>In my library</span>
            </a>
            {% endif %}
          </p>
          {% if game.steamid %}
          <a href="http://store.steampowered.com/app/{{ game.steamid }}/" class="box-link">
            <img src="{{ STATIC_URL }}images/steam.png" alt="" />
            Get it on Steam
          </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}
