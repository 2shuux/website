{% extends "base.html" %}
{% load thumbnail %}


{% block stylesheets %}
  <link rel="stylesheet" href="{{ STATIC_URL }}css/nivo-slider.css" />
  <link rel="stylesheet" href="{{ STATIC_URL }}css/themes/dark/dark.css" />
{% endblock %}


{% block content %}
  <div class="game-header"
       {% thumbnail game.title_logo banner_size options=banner_options as banner %}
       style="background-image: url('{{ banner.url }}')"
       {% endthumbnail %}>
    <h1>
      {% if game.icon %}
        <img src='{{ MEDIA_URL }}{{ game.icon }}' width='128' height='128' class='icon' />
      {% endif %}
      {{ game.name }}
    </h1>
  </div>
  <div class="row">
    <div class="span9">
      {% with game.screenshot_set.published as screenshots %}
        {% if screenshots %}
          <div class="slider-wrapper theme-dark">
            <div class='screenshots nivoSlider'>
              {% for screenshot in game.screenshot_set.published %}
                {% thumbnail screenshot.image '640x480' crop="center" as img %}
                  <img src="{{ MEDIA_URL }}/{{ img }}" title="{{ screenshot.description }}" />
                {% endthumbnail %}
              {% endfor %}
            </div>
          </div>
        {% endif %}
      {% endwith %}
      <a href='{% url 'screenshot_add' game.slug %}'>Add one ?</a>
    </div>
    <div class="span3">
      <div class="game-info">
        {% thumbnail game.cover "220" as img %}
        <img src="{{ img.url }}" />
        {% endthumbnail %}

        <strong>Genre: </strong>
        {% for genre in game.genres.all %}
          {{ genre }}{% if not forloop.last %}, {% endif %}
        {% endfor %}

        <strong>Platform: </strong>
        {% for platform in game.platforms.all %}
          {{ platform }}
        {% endfor %}

        <strong>Developer: </strong>
        {% firstof game.developer "Unknown" %}
        <strong>Publisher: </strong>
        {% firstof game.publisher "Unknown" %}
        <strong>Release date: </strong>
        {% firstof game.year "Unknown" %}
        {% if game.website %}
          <strong>Website: </strong>
          <a href='{{ game.website }}' >{{ game.website }}</a>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="span9">
  <p>
    {{ game.description }}
  </p>
  {% url 'new_installer' slug=game.slug as installer_url %}
  {% for installer in game.installer_set.all %}
    <div>
      <span class="label label-important">{{ installer.slug }}</span> for {{ installer.runner }},
      submitted by {{ installer.user.username }}
      <a href='lutris:{{ installer.slug }}' class="pull-right btn btn-inverse btn-large">Install</a>
      {% if installer.user == user %}
      {% url 'edit_installer' slug=installer.slug as edit_url %}
      <a href="{{ edit_url }}">Edit installer </a>
      {% endif %}
      {% url 'serve_installer' slug=installer.slug as download_url %}
      <a href="{{ download_url }}">Download raw installer</a>
    </div>
    {% if forloop.last %}
    <div>
      <a href="{{ installer_url }}" class="btn btn-small btn-inverse">Write a new installer</a>
    </div>
    {% endif %}
  {% empty %}
    Oh noes! No installer has been written for this game.
    Why don't you <a href="{{ installer_url }}" class="btn btn-small btn-inverse">write one</a> ?
  {% endfor %}
  </div>
{% endblock %}
{% block scripts %}
   {% include "includes/_nivoslider.html" %}
{% endblock %}
